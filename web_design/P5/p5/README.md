# 项目数据可视化系统

这是一个基于H5的前端数据可视化系统，可以直接在浏览器中打开并导入Excel或CSV文件进行数据可视化展示，无需服务器支持。

## 功能特点

- 支持Excel和CSV文件导入和解析
- 项目总体情况展示（总收入、合同总金额、价值工作量等8个指标）
- 单任务详细分析（包括时间差、每米收入成本等6个指标）
- 多种图表展示（工作时间圆饼图、收入占比圆饼图、计划与实际进度对比甘特图）
- 项目和任务筛选功能
- 响应式设计，适配不同设备

## 数据字段说明

系统支持以下19个数据字段：

1. 项目名称（文本）
2. 年度（时间：yyyy）
3. 任务名称（文本）
4. 工作分解结构描述（文本）
5. 计划开始时间（日期：yyyy:mm:dd）
6. 计划完成时间（日期：yyyy:mm:dd）
7. 实际开始时间（日期：yyyy:mm:dd）
8. 实际完成时间（日期：yyyy:mm:dd）
9. 实际工作量（数字）
10. 单位（文本）
11. 综合单价（数字）
12. 附加费用（数字）
13. 合计价值工作量（数字）
14. 任务成本（数字）
15. 收入计划（数字）
16. 确认收入时间（日期：yyyy:mm:dd）
17. 已确认金额（数字）
18. 收现时间（日期：yyyy:mm:dd）
19. 收现金额（数字）

## 使用方法

1. 直接在浏览器中打开 `index.html` 文件
2. 点击"选择Excel文件"按钮，上传包含数据的Excel文件（.xlsx或.xls格式）
3. 系统将自动解析数据并展示可视化结果
4. 使用项目选择器和任务选择器可以筛选查看特定数据

## Excel文件格式要求

- 第一行应为列标题，包含上述19个字段
- 数据从第二行开始
- 日期格式支持：yyyy-mm-dd、yyyy/mm/dd、mm-dd-yyyy、mm/dd/yyyy
- 数字字段应使用数字格式，不要包含文本符号

## 技术栈

- HTML5
- CSS3
- JavaScript
- Chart.js（图表库）
- SheetJS（Excel解析库）

## 浏览器兼容性

- Chrome 60+
- Firefox 55+
- Safari 12+
- Edge 79+

## 示例数据

项目中包含一个 `示例数据.csv` 文件，您可以使用此文件测试系统功能。注意：系统主要设计用于Excel文件，但也可以处理CSV文件。

## 注意事项

1. 由于浏览器安全限制，某些浏览器可能无法直接打开本地HTML文件，建议使用本地服务器（如Live Server插件）运行
2. 大型Excel文件可能需要较长处理时间
3. 确保Excel文件中的数据格式正确，特别是日期和数字格式

## 计算指标说明

### 项目总体情况指标

- **合同总金额(TCV)**：所有项目的合计价值工作量总和
- **价值工作量(EV)**：所有项目的合计价值工作量总和
- **已确认收入(RR)**：所有项目的已确认金额总和
- **已开票未回款(AR)**：RR - CC
- **收现(CC)**：所有项目的收现金额总和
- **收入计划(RRP)**：所有项目的收入计划总和
- **回款率**：CC / TCV * 100%
- **收入偏差(RevCV)**：RR - RRP

### 单任务分析指标

- **收入确认时间差**：收入确认时间 - 任务最后一项完成的时间
- **收现时间差**：收现时间 - 任务最后一项完成的时间
- **收入平均确认时间**：所有子任务收入确认时间差的平均值
- **收现平均确认时间**：所有子任务收现时间差的平均值
- **每米收入**：单个任务的合计价值工作量之和 / 单个任务中所有单位为米的实际工作量之和
- **每米成本**：单个任务的任务成本之和 / 单个任务中所有单位为米的实际工作量之和