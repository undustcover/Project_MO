# 进度仪表盘页面微调优化方案

## 目标与范围
- 提升进度仪表盘的交互体验、视觉层次与可读性
- 完善数据导入/校核、周期筛选、计划与实际对比、导出能力
- 统一主题配色与组件风格，加入骨架屏加载占位

---

## 后端接口与数据规则
- 井号列表与周期数据筛选
  - 井号列表：`GET /api/dashboard/progress/wells`（apps/server/src/progress/progress.controller.ts:59-62）
  - 周期明细：`GET /api/dashboard/progress/cycleDetail`（apps/server/src/progress/progress.controller.ts:64-73；apps/server/src/progress/progress.service.ts:182-213）
  - 周期分解：`GET /api/dashboard/progress/cycleBreakdown`（apps/server/src/progress/progress.controller.ts:75-84；apps/server/src/progress/progress.service.ts:215-245）
- 实际进度 Excel 模板与导入
  - 模板下载：`GET /api/dashboard/progress/template`（apps/server/src/progress/progress.controller.ts:86-96）
  - 导入并校核：`POST /api/dashboard/progress/import`（apps/server/src/progress/progress.controller.ts:108-165）
    - 每日总时效（同项目+井号+日期）上限 24 小时，超限拒绝（apps/server/src/progress/progress.controller.ts:151-157）
    - 重复导入覆盖同日数据（先删后存）（apps/server/src/progress/progress.controller.ts:158-163）
    - 日期格式统一规范化，兼容 `YYYY/MM/DD`、`YYYY.MM.DD`、`YYYY:MM:DD`（apps/server/src/progress/progress.controller.ts:229-238）
- 计划数据 Excel 模板与导入/对比
  - 模板下载：`GET /api/dashboard/progress/plan/template`（apps/server/src/progress/progress.controller.ts:167-177）
  - 导入：`POST /api/dashboard/progress/plan/import`（apps/server/src/progress/progress.controller.ts:179-202），入库前明确项目关联（apps/server/src/progress/progress.service.ts:130-138）
  - 计划与实际对比：`GET /api/dashboard/progress/plan/compare`（apps/server/src/progress/progress.controller.ts:204-207）
    - 返回列表与双柱图所需数据（计划时长/实际时长）（apps/server/src/progress/progress.service.ts:140-180）
- 实际进度清空
  - 按项目或全量清空实际进度：`DELETE /api/dashboard/progress/actual`（apps/server/src/progress/progress.controller.ts:98-106）
- 仪表盘聚合口径
  - 四大周期、生产/非生产时效与关键时效聚合逻辑（apps/server/src/progress/progress.service.ts:16-60）

---

## 前端页面与交互优化
- 周期选择替代“工况名称”选择，联动仪表盘与对比视图（apps/web/src/pages/progress/ProgressDashboard.vue:13-15, 212-224）
- 井号筛选与日期范围筛选联动（apps/web/src/pages/progress/ProgressDashboard.vue:10-11, 551-555）
- 下载模板图标化并悬浮提示（apps/web/src/pages/progress/ProgressDashboard.vue:20-25, 28-32, 626-632）
- 评分明细与度量明细的布局交换与文案标签化（apps/web/src/pages/progress/ProgressDashboard.vue:49-67, 114-121）
- 项目评价标签与等级标签（apps/web/src/pages/progress/ProgressDashboard.vue:41-53）
- 骨架屏加载占位（雷达图/饼图图块）（apps/web/src/pages/progress/ProgressDashboard.vue:39-41, 72-75, 79-81）

---

## 图表与可视化改进
- 雷达图
  - 交互提示显示维度名称与分数（apps/web/src/pages/progress/ProgressDashboard.vue:239-249）
  - 指标名称绑定到雷达轴，现代化配色与线/面样式（apps/web/src/pages/progress/ProgressDashboard.vue:250-264）
- 柱状图
  - 统一配色，栅格与轴样式优化（apps/web/src/pages/progress/ProgressDashboard.vue:437-455）
- 饼图（建井周期与时效对比）
  - 现代配色、环形比例、提示格式化（apps/web/src/pages/progress/ProgressDashboard.vue:497-515, 521-533）
- 计划与实际双柱对比（计划(d)/实际(d)）
  - 图例与数据源对齐（apps/web/src/pages/progress/ProgressDashboard.vue:596-609）

---

## 度量明细随周期联动
- 依据所选周期与分解数据动态刷新：生产/非生产/中完/纯钻/起下钻/进尺工作时间、建井周期（apps/web/src/pages/progress/ProgressDashboard.vue:270-318）

---

## 导出能力与样式
- 单页 PDF 导出：基于 `html2pdf.js` 生成不分页的整页 PDF（apps/web/src/pages/progress/ProgressDashboard.vue:457-486）
  - 预加载库并出错回退打印（apps/web/src/pages/progress/ProgressDashboard.vue:413-423, 488-495）
  - 导出前刷新图表尺寸，保持背景与字体一致
- 打印样式 A3 调优（apps/web/src/pages/progress/ProgressDashboard.vue:637-647）

---

## 主题与品牌
- 统一主题变量（品牌色、文本色、圆角、阴影、背景），提升一致性（apps/web/src/App.vue:35-45）
- 顶部品牌标识与深浅色布局（apps/web/src/App.vue:19-23, 35-45）
- 卡片圆角与阴影、图标按钮风格（apps/web/src/pages/progress/ProgressDashboard.vue:629-633, 631-633）

---

## 使用与验证建议
- 数据导入
  - 实际进度按模板列顺序导入；同日总时效不超过 24h；重复导入覆盖
  - 计划导入按模板列顺序；支持 `YYYY/MM/DD` 等日期格式
- 过滤与联动
  - 顶部选择项目后，井号与周期筛选联动；度量明细、雷达与饼图同步更新
- 导出
  - 使用“导出PDF”生成整页单页 PDF；长度较长时自动拓展单页尺寸
- 主题
  - 可扩展暗/亮主题切换；建议后续统一抽取全站变量到单独主题文件

---

## 后续优化空间
- 增加空数据占位与错误提示，完善反馈
- 进一步统一表格与按钮的动效与状态颜色
- 导出 PDF 增加页眉信息（项目名/井号/日期范围）与 A3/A4 适配缩放选项